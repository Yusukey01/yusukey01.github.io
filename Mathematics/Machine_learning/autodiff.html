---
layout: default
title: Neural Networks Basics
level: detail
description: Learn about the automatic differentiation.
uses_math: true
uses_python: false
---
<!DOCTYPE html>
<html>
    <body> 
        <div class="hero-section">
            <h1 class="webpage-name"> Automatic Differentiation</h1>
        </div>

        <div class="topic-nav">
            <a href="#AD">Automatic Differentiation</a>
            <a href="#eg">Analytic Example of Reverse-Mode AD</a>
            <a href="#"></a>
            <a href="#"></a>
              
        </div> 

        <div class="container">  

            <section id="AD" class="section-content">
                <h2>Automatic Differentiation</h2>
                <p>
                    In multilayer perceptrons (MLPs), <strong>backpropagation</strong> is an efficient application of the chain rule to compute gradients layer by layer. 
                    More generally, this technique is known as <strong>automatic differentiation (AD)</strong>. AD is not limited to sequential layers. It applies to arbitrary 
                    <strong>computational graphs</strong>, which are directed acyclic graphs (DAGs) that represent how variables are computed from inputs to outputs.
                </p>

                <p>
                    Automatic differentiation systematically applies the chain rule over this graph structure to compute exact derivatives. 
                    In <strong>reverse-mode AD</strong> — which underlies backpropagation — we begin at the output node and work backwards, 
                    accumulating gradients with respect to each variable.
                </p>
            </section>

            <section id="eg" class="section-content">
                <h2>Analytic Example of Reverse-Mode AD</h2>
                <p>
                    To make the process of automatic differentiation concrete, let's walk through an analytic example using a 
                    composite scalar-valued function of two variables. We'll decompose the function into primitive operations, 
                    represent it as a computational graph, and compute its gradients using <strong>reverse-mode automatic differentiation</strong> 
                    (i.e., backpropagation).
                </p>

                <p>
                    Consider a function
                    \[
                    f(x_1, x_2) = \log \left((x_1 + x_2)^2 + \sin(x_1 x_2) \right).
                    \]
                    We decompose this into primitive operations:
                    \[
                    \begin{align*}
                    &x_3 = x_1 + x_2 \\\\
                    &x_4 = x_3^2 \\\\
                    &x_5 = x_1 x_2 \\\\
                    &x_6 = \sin(x_5) \\\\
                    &x_7 = x_4 + x_6 \\\\
                    &x_8 = \log(x_7) = f \\\\
                    \end{align*}
                    \]
                </p>

                <div style="max-width: 800px; margin: 20px auto; background: white; padding: 20px; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.1);">
                    <svg viewBox="0 0 800 650" xmlns="http://www.w3.org/2000/svg">
                      <defs>
                        <!-- Arrow marker for forward pass -->
                        <marker id="arrowhead" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                          <polygon points="0 0, 10 3, 0 6" fill="#333" />
                        </marker>
                        
                        <!-- Arrow marker for backward pass -->
                        <marker id="arrowhead-red" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
                          <polygon points="0 0, 10 3, 0 6" fill="#e74c3c" />
                        </marker>
                        
                        <!-- Gradient for nodes -->
                        <linearGradient id="nodeGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#4a90e2;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#357abd;stop-opacity:1" />
                        </linearGradient>
                        
                        <linearGradient id="inputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#5cb85c;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#449d44;stop-opacity:1" />
                        </linearGradient>
                        
                        <linearGradient id="outputGradient" x1="0%" y1="0%" x2="100%" y2="100%">
                          <stop offset="0%" style="stop-color:#d9534f;stop-opacity:1" />
                          <stop offset="100%" style="stop-color:#c9302c;stop-opacity:1" />
                        </linearGradient>
                      </defs>
                      
                      <!-- Title -->
                      <text x="400" y="30" text-anchor="middle" font-size="24" font-weight="bold" fill="#333">
                        Computational Graph for f(x₁, x₂) = log((x₁ + x₂)² + sin(x₁x₂))
                      </text>
                      
                      <!-- Input nodes -->
                      <g id="input-nodes">
                        <circle cx="200" cy="100" r="30" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
                        <text x="200" y="107" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₁</text>
                        
                        <circle cx="600" cy="100" r="30" fill="url(#inputGradient)" stroke="#333" stroke-width="2"/>
                        <text x="600" y="107" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₂</text>
                      </g>
                      
                      <!-- Intermediate nodes -->
                      <g id="intermediate-nodes">
                        <!-- x3 = x1 + x2 -->
                        <circle cx="400" cy="200" r="30" fill="url(#nodeGradient)" stroke="#333" stroke-width="2"/>
                        <text x="400" y="207" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₃</text>
                        <text x="405" y="240" text-anchor="middle" font-size="14" fill="#333">x₁ + x₂</text>
                        
                        <!-- x5 = x1 * x2 -->
                        <circle cx="400" cy="300" r="30" fill="url(#nodeGradient)" stroke="#333" stroke-width="2"/>
                        <text x="400" y="307" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₅</text>
                        <text x="400" y="345" text-anchor="middle" font-size="14" fill="#333">x₁ × x₂</text>
                        
                        <!-- x4 = x3^2 -->
                        <circle cx="300" cy="400" r="30" fill="url(#nodeGradient)" stroke="#333" stroke-width="2"/>
                        <text x="300" y="407" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₄</text>
                        <text x="295" y="445" text-anchor="middle" font-size="14" fill="#333">x₃²</text>
                        
                        <!-- x6 = sin(x5) -->
                        <circle cx="500" cy="400" r="30" fill="url(#nodeGradient)" stroke="#333" stroke-width="2"/>
                        <text x="500" y="407" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₆</text>
                        <text x="500" y="445" text-anchor="middle" font-size="14" fill="#333">sin(x₅)</text>
                        
                        <!-- x7 = x4 + x6 -->
                        <circle cx="400" cy="480" r="30" fill="url(#nodeGradient)" stroke="#333" stroke-width="2"/>
                        <text x="400" y="487" text-anchor="middle" font-size="18" font-weight="bold" fill="white">x₇</text>
                        <text x="435" y="487" text-anchor="start" font-size="14" fill="#333">x₄ + x₆</text>
                      </g>
                      
                      <!-- Output node -->
                      <g id="output-node">
                        <circle cx="400" cy="580" r="30" fill="url(#outputGradient)" stroke="#333" stroke-width="2"/>
                        <text x="400" y="587" text-anchor="middle" font-size="16" font-weight="bold" fill="white">x₈ = f</text>
                        <text x="400" y="625" text-anchor="middle" font-size="14" fill="#333">log(x₇)</text>
                      </g>
                      
                      <!-- Forward edges (black) -->
                      <g id="forward-edges" fill="none" stroke="#333" stroke-width="2">
                        <!-- x1 to x3 -->
                        <path d="M 220 120 Q 300 150 380 180" marker-end="url(#arrowhead)"/>
                        
                        <!-- x2 to x3 -->
                        <path d="M 580 120 Q 500 150 420 180" marker-end="url(#arrowhead)"/>
                        
                        <!-- x1 to x5 -->
                        <path d="M 200 130 Q 200 250 370 285" marker-end="url(#arrowhead)"/>
                        
                        <!-- x2 to x5 -->
                        <path d="M 600 130 Q 600 250 430 285" marker-end="url(#arrowhead)"/>
                        
                        <!-- x3 to x4 -->
                        <path d="M 380 220 Q 340 300 315 375" marker-end="url(#arrowhead)"/>
                        
                        <!-- x5 to x6 -->
                        <path d="M 420 320 Q 460 350 485 375" marker-end="url(#arrowhead)"/>
                        
                        <!-- x4 to x7 -->
                        <path d="M 320 420 Q 360 440 380 460" marker-end="url(#arrowhead)"/>
                        
                        <!-- x6 to x7 -->
                        <path d="M 480 420 Q 440 440 420 460" marker-end="url(#arrowhead)"/>
                        
                        <!-- x7 to f -->
                        <path d="M 400 510 L 400 550" marker-end="url(#arrowhead)"/>
                      </g>
                      
                      <!-- Backward edges (red) - gradient flow -->
                      <g id="backward-edges" fill="none" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5,5" opacity="0.8">
                        <!-- f to x7 -->
                        <path d="M 415 555 L 415 515" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x7 to x4 -->
                        <path d="M 385 465 Q 345 445 325 425" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x7 to x6 -->
                        <path d="M 415 465 Q 455 445 475 425" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x4 to x3 -->
                        <path d="M 285 375 Q 325 295 385 225" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x6 to x5 -->
                        <path d="M 485 380 Q 445 350 415 325" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x3 to x1 -->
                        <path d="M 385 185 Q 305 155 225 125" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x3 to x2 -->
                        <path d="M 415 185 Q 495 155 575 125" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x5 to x1 -->
                        <path d="M 385 280 Q 230 200 215 135" marker-end="url(#arrowhead-red)"/>
                        
                        <!-- x5 to x2 -->
                        <path d="M 415 280 Q 570 200 585 135" marker-end="url(#arrowhead-red)"/>
                      </g>
                      
                      <!-- Legend -->
                      <g id="legend" transform="translate(20, 480)">
                        <rect x="0" y="0" width="250" height="140" fill="#f8f8f8" stroke="#ddd" stroke-width="1" rx="5"/>
                        <text x="100" y="20" text-anchor="middle" font-size="16" font-weight="bold" fill="#333">Legend</text>
                        
                        <circle cx="20" cy="40" r="10" fill="url(#inputGradient)" stroke="#333" stroke-width="1"/>
                        <text x="40" y="45" font-size="14" fill="#333">Input variables</text>
                        
                        <circle cx="20" cy="65" r="10" fill="url(#nodeGradient)" stroke="#333" stroke-width="1"/>
                        <text x="40" y="70" font-size="14" fill="#333">Intermediate values</text>
                        
                        <circle cx="20" cy="90" r="10" fill="url(#outputGradient)" stroke="#333" stroke-width="1"/>
                        <text x="40" y="95" font-size="14" fill="#333">Output</text>
                        
                        <path d="M 10 115 L 30 115" stroke="#333" stroke-width="2" marker-end="url(#arrowhead)"/>
                        <text x="40" y="120" font-size="14" fill="#333">Forward pass</text>
                        
                        <path d="M 130 115 L 150 115" stroke="#e74c3c" stroke-width="2" stroke-dasharray="5,5" marker-end="url(#arrowhead-red)"/>
                        <text x="160" y="120" font-size="14" fill="#333">Gradient flow</text>
                      </g>
                      
                       <!-- Gradient annotations with white background for visibility -->
                      <g id="gradient-annotations" font-size="11" fill="#e74c3c" font-weight="bold">
                        <!-- Add white rectangles behind text for better visibility -->
                       
                        <text x="440" y="535">∂f/∂x₇ = 1/x₇</text>
                        
                       
                        <text x="200" y="410">∂f/∂x₄ = 1/x₇</text>
                        
                       
                        <text x="530" y="410">∂f/∂x₆ = 1/x₇</text>
                        
                      
                        <text x="285" y="210">∂f/∂x₃ = 2x₃/x₇</text>
                        
                        
                        <text x="460" y="310">∂f/∂x₅ = cos(x₅)/x₇</text>
                      </g>

                    </svg>
                </div>


                <p style="margin-top: 20px;">
                    This computational graph clearly shows the DAG (Directed Acyclic Graph) structure. Notice how:
                    <ul  style="padding-left: 40px;">
                        <li>Each input variable (x₁ and x₂) has <strong>multiple outgoing edges</strong>, contributing to different intermediate computations</li>
                        <li>The graph flows from inputs at the top to the output at the bottom</li>
                        <li>During backpropagation, gradients flow in the <strong>reverse direction</strong> (from f back to x₁ and x₂)</li>
                    </ul>
                </p>

                <p>
                    Starting from the output and working backwards:
                    \[
                    \begin{align*}
                    \frac{\partial f}{\partial x_8} &= 1  \\\\

                    \frac{\partial f}{\partial x_7} &= \frac{\partial f}{\partial x_8} \cdot \frac{\partial x_8}{\partial x_7} \\\\
                                                    &= 1 \cdot \frac{1}{x_7} = \frac{1}{x_7} \\\\

                    \frac{\partial f}{\partial x_4} &=  \frac{\partial f}{\partial x_7} \cdot \frac{\partial x_7}{\partial x_4} \\\\
                                                    &=  \frac{1}{x_7} \cdot 1 = \frac{1}{x_7} \\\\

                    \frac{\partial f}{\partial x_6} &=  \frac{\partial f}{\partial x_7} \cdot \frac{\partial x_7}{\partial x_6} \\\\
                                                    &=  \frac{1}{x_7} \cdot 1 = \frac{1}{x_7} \\\\

                    \frac{\partial f}{\partial x_3} &=  \frac{\partial f}{\partial x_4} \cdot \frac{\partial x_4}{\partial x_3} \\\\
                                                    &=  \frac{1}{x_7}  \cdot 2 x_3\\\\

                    \frac{\partial f}{\partial x_5} &=  \frac{\partial f}{\partial x_6} \cdot \frac{\partial x_6}{\partial x_5} \\\\
                                                    &=  \frac{1}{x_7} \cdot \cos(x_5)\\\\                               
                    \end{align*}
                    \]
                </p>

                <p>
                    Notice that the input variables \(x_1\) and \(x_2\) each contribute to multiple intermediate nodes:
                    <ul style="padding-left: 40px;">
                        <li>\(x_1\) influences both \(x_3\) (via addition) and \(x_5\) (via multiplication)</li>
                        <li>\(x_2\) influences both \(x_3\) (via addition) and \(x_5\) (via multiplication)</li>
                    </ul>
                    This means we need to <strong>sum the gradients</strong> from all paths when computing the final derivatives.
                </p>

                <p>
                    To find the gradients with respect to the input variables, we sum contributions from all paths:
                </p>
                
                <p>
                    For \(\frac{\partial f}{\partial x_1}\):
                    \[
                    \begin{align*}
                    \frac{\partial f}{\partial x_1} &= \frac{\partial f}{\partial x_3} \cdot \frac{\partial x_3}{\partial x_1} + \frac{\partial f}{\partial x_5} \cdot \frac{\partial x_5}{\partial x_1} \\\\
                                                    &= \frac{2x_3}{x_7} \cdot 1 + \frac{\cos(x_5)}{x_7} \cdot x_2 \\\\
                                                    &= \frac{1}{x_7} \left[2x_3 + x_2 \cos(x_5)\right]
                    \end{align*}
                    \]
                </p>

                <p>
                    For \(\frac{\partial f}{\partial x_2}\):
                    \[
                    \begin{align*}
                    \frac{\partial f}{\partial x_2} &= \frac{\partial f}{\partial x_3} \cdot \frac{\partial x_3}{\partial x_2} + \frac{\partial f}{\partial x_5} \cdot \frac{\partial x_5}{\partial x_2} \\\\
                                                    &= \frac{2x_3}{x_7} \cdot 1 + \frac{\cos(x_5)}{x_7} \cdot x_1 \\\\
                                                    &= \frac{1}{x_7} \left[2x_3 + x_1 \cos(x_5)\right]
                    \end{align*}
                    \]
                </p>

                 <p>
                    Replacing the intermediate variables with their expressions in terms of \(x_1\) and \(x_2\):
                    <ul style="padding-left: 40px;">
                        <li>\(x_3 = x_1 + x_2\)</li>
                        <li>\(x_5 = x_1 x_2\)</li>
                        <li>\(x_7 = (x_1 + x_2)^2 + \sin(x_1 x_2)\)</li>
                    </ul>
                    
                    Finally, we get the derivatives:
                    \[
                    \boxed{
                    \begin{align*}
                    \frac{\partial f}{\partial x_1} &= \frac{2(x_1 + x_2) + x_2 \cos(x_1 x_2)}{(x_1 + x_2)^2 + \sin(x_1 x_2)} \\\\
                    \frac{\partial f}{\partial x_2} &= \frac{2(x_1 + x_2) + x_1 \cos(x_1 x_2)}{(x_1 + x_2)^2 + \sin(x_1 x_2)}
                    \end{align*}
                    }
                    \]
                </p>

                 <p>
                    The power of automatic differentiation lies in its systematic approach:
                    <ol style="padding-left: 40px;">
                        <li>Decompose complex functions into simple primitive operations</li>
                        <li>Apply the chain rule mechanically through the computational graph</li>
                        <li>Sum gradients when variables contribute through multiple paths</li>
                    </ol>
                    This process can be fully automated, making it the backbone of modern deep learning frameworks.
                </p>
            </section>

              

            <section id="" class="section-content">
                <h2></h2>

            </section>



        </div>
        <script src="/js/main.js"></script> 
    </body>
</html>