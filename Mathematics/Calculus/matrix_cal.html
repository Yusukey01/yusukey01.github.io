---
layout: default
title: Matrix Calculus
level: detail
description: Learn about derivative of matrix functions.
uses_math: true
uses_python: false
---
<!DOCTYPE html>
<html>
    <body> 
        <!-- LearningResource Schema for Matrix Calculus -->
        <script type="application/ld+json">
        {
        "@context": "https://schema.org",
        "@type": "LearningResource",
        "name": "The Derivative of f:ℝⁿˣⁿ → ℝⁿˣⁿ",
        "description": "Learn about derivative of matrix functions",
        "learningResourceType": "lesson",
        "educationalUse": "instruction",
        "educationalLevel": "university",
        "interactivityType": "active",
        "author": {
            "@type": "Person",
            "name": "Yusuke Yokota",
            "jobTitle": "Mathematics & Computer Science Educator",
            "knowsAbout": [
            "Matrix Calculus",
            "Matrix Functions",
            "Linear Algebra",
            "Mathematical Analysis",
            "Matrix Decomposition",
            "Differential Calculus"
            ]
        },
        "publisher": {
            "@type": "Organization",
            "name": "MATH-CS COMPASS",
            "url": "https://yusukey01.github.io"
        },
        "about": [
            { "@type": "Thing", "name": "Matrix Calculus" },
            { "@type": "Thing", "name": "Matrix-valued Functions" },
            { "@type": "Thing", "name": "Matrix Derivatives" },
            { "@type": "Thing", "name": "Square Matrix Functions" },
            { "@type": "Thing", "name": "Matrix Inverse" },
            { "@type": "Thing", "name": "Matrix Powers" },
            { "@type": "Thing", "name": "LU Decomposition" },
            { "@type": "Thing", "name": "Lower Triangular Matrix" },
            { "@type": "Thing", "name": "Upper Triangular Matrix" },
            { "@type": "Thing", "name": "Matrix Factorization" },
            { "@type": "Thing", "name": "Product Rule for Matrices" },
            { "@type": "Thing", "name": "Differential Notation" },
            { "@type": "Thing", "name": "Linear Operator" },
            { "@type": "Thing", "name": "Matrix Multiplication" },
            { "@type": "Thing", "name": "Non-commutative Operations" }
        ],
        "teaches": [
            "Computing derivatives of matrix-valued functions",
            "Understanding the product rule for matrix functions",
            "Working with matrix powers and their derivatives",
            "Computing derivatives of matrix inverses",
            "Understanding LU decomposition derivatives",
            "Working with triangular matrix properties",
            "Applying differential notation to matrix calculus",
            "Understanding non-commutative matrix operations in calculus"
        ],
        "isPartOf": {
            "@type": "Course",
            "name": "Calculus to Optimization & Analysis",
            "description": "Explore optimization techniques and mathematical analysis with applications",
            "provider": {
            "@type": "Organization",
            "name": "MATH-CS COMPASS",
            "url": "https://yusukey01.github.io"
            },
            "instructor": {
            "@type": "Person",
            "name": "Yusuke Yokota",
            "jobTitle": "Mathematics & Computer Science Educator"
            },
            "courseCode": "II",
            "hasCourseInstance": {
            "@type": "CourseInstance",
            "courseMode": "online",
            "courseWorkload": "PT3H",
            "instructor": {
                "@type": "Person",
                "name": "Yusuke Yokota"
            }
            },
            "offers": {
            "@type": "Offer",
            "price": "0",
            "priceCurrency": "USD",
            "availability": "https://schema.org/InStock",
            "category": "free"
            }
        }
        }
        </script>
        <div class="hero-section">
            <h1 class="webpage-name"> The Derivative of \(f:\mathbb{R}^{n \times n} \rightarrow \mathbb{R}^{n \times n}\)
            </h1>
        </div>

        {% include section_navigation.html %}

        <div class="topic-nav">
            <a href="#square">Derivative of the square matrix functions</a>
            <a href="#lu">Derivative of the LU decomposition matrix</a> 
        </div> 

        <div class="container">  
           
            <section id="square" class="section-content">
            <h2>Derivative of the square matrix functions</h2>
            <p>
            So far, we have discussed the familiar derivatives such as gradients and Jacobian matrices. Here, we consider 
            the derivative of matrix-valued function \(f\) with respect to the matrix input \(X\).  
            \[
            df = \frac{\partial f}{\partial X}dX
            \]
            <br>
            For example, consider \(f(X) = X^3\) where \(X \in \mathbb{R}^{n \times n}\). We want to find the most general 
            symbolic expression for the derivative of this function using differential notation. 
            <br>
            By the product rule,
            \[
            \begin{align*}
            df &=  (dX) X X  + X(dX)X  +X X (dX) \\\\
               &= (dX)X^2 + X(dX)X + X^2(dX) \tag{1}
            \end{align*}
            \]
            Let's verify this expression using the definition of total differential \(df\):
            \[
            \begin{align*}
            df &= f(X + dX) - f(X) \\\\
               &= (X+dX)^3 - X^3 \\\\
               &= (X+dX)(X+dX)(X+dX) - X^3 \\\\
               &= X^3 + X^2(dX) + X(dX)X + X(dX)^2 + (dX)X^2 \\\\
               &\quad + (dX)X(dX) + (dX)^2X + (dX)^3 - X^3
            \end{align*}
            \]
            Since the higher order terms are negligible as \(dX \to 0\), we obtain the expression (1).
            <br>
            Note: Matrix multiplication is not commutative. 
            <br><br>
            Next, consider \(f(X) = X^{-1}\), where \(X\) is an invertible matrix. 
            <br>
            Since \(X^{-1}X = I\),
            \[
            d(X^{-1}X) = d(I) = 0 \, \in \mathbb{R}^{m \times n}.
            \]
            Then by the product rule,
            \[
            \begin{align*}
            &df = d(X^{-1})X + X^{-1}(dX) = 0 \\\\
            &\Longrightarrow  d(X^{-1})X = - X^{-1}(dX).
            \end{align*}
            \]
            Thus, 
            \[
            df = d(X^{-1}) = - X^{-1}(dX)X^{-1}.
            \]
            </p>
            </section>
            
            <section id="lu" class="section-content">
            <h2>Derivative of the LU decomposition matrix</h2>
            <p>
            In the LU decomposition, a square matrix \(X\) is factorized into a product of a lower triangular matrix \(L\) with 
            unit diagonal entries, and an upper triangular matrix \(U\).
            <br>
            By the product rule:
            \[
            d(X) = d(LU) = (dL)U + L(dU)
            \]
            Note: Both matrices \(dL\) and \(dU\) are also triangular. 
            <br>
            For example, 
            <br>
            Let 
            \[
            L = \begin{bmatrix} 1 & 0 \\ L_{21} & 1 \end{bmatrix}
            \] 
            and 
            \[U = \begin{bmatrix} U_{11} & U_{12} \\ 0 & U_{22} \end{bmatrix} \]
            Then we obtain their differentials:
            \[
            dL = \begin{bmatrix} 0 & 0 \\ d(L_{21}) & 0 \end{bmatrix} 
            \] 
            and 
            \[dU = \begin{bmatrix} d(U_{11}) & d(U_{12}) \\ 0 & d(U_{22}) \end{bmatrix} \].
            <br>
            Thus,
            \[
            \begin{align*}
            d(X) &= \begin{bmatrix} 0 & 0 \\ d(L_{21}) & 0 \end{bmatrix}\begin{bmatrix}  U_{11} & U_{12} \\ 0 & U_{22} \end{bmatrix}
                 + \begin{bmatrix} 1 & 0 \\ L_{21} & 1 \end{bmatrix}\begin{bmatrix} d( U_{11}) & d(U_{12}) \\ 0 & d(U_{22}) \end{bmatrix}\\\\
                &= \begin{bmatrix} d( U_{11}) & d(U_{12}) \\ d(L_{21}) & d(U_{22}) \end{bmatrix}
            \end{align*}
            \]
            </p>
            </section>
        </div>
        <script src="/js/main.js"></script> 
    </body>
</html>