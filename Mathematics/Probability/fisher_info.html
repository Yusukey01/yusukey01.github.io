<!DOCTYPE html>
<html>
    <head> 
        <title>Fisher Information Matrix</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <link rel="stylesheet" href="../styles.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body> 
        <h1>Fisher Information Matrix</h1>
        <blockquote>
            The <strong>Fisher information matrix</strong> is related to the <strong>curvature</strong> of log 
            likelihood functions. In frequentist statistics, it characterizes the sampling distribution of the MLE. On the 
            other hand, in Bayesian statistics, it used to derive Jeffreys' uninformative priors. In addition, FIM is introduced 
            as a part of optimization methods such as the natural gradient descent. 
            <br><br>
            First, we define a <strong>score function</strong> as the gradient of the log likelihood with respect 
            to the parameter vector \(\theta\):
            \[
            s(\theta) = \nabla_{\theta} \log p(x | \theta).
            \]
            The <strong>Fisher information matrix (FIM)</strong> is defined to be the <a href="covariance.html"><strong>covariance </strong></a> of the 
            score function:
            \[
            F(\theta) = \mathbb{E }_{x \sim p(x|\theta)} [s(\theta)s(\theta)^T].
            \]
            <div class="theorem">
                <span class="theorem-title">Theorem 1:</span>
                If \( \log p(x |\theta)\) is twice differentiable, and under certain regularity conditions, the
                the Fisher information matrix equals the expected Hessian of the negative log likelihood (NLL):
                \[
                F(\theta) = - \mathbb{E }_{x \sim \theta} [\nabla_{\theta}^2 \log p(x |\theta)].
                \]
            </div>
            <div class="proof">
                <span class="proof-title">Proof:</span>
                First, the expected value of the score function \(s(\theta)\) is zero. In scalar case, assuming that \(p(x | \theta)\) is differentiable and 
                the bounds of the integral do not depend on \(\theta\), we have 
                \[
                \begin{align*}
                &\int p(x | \theta) dx = 1  \\\\
                &\Longrightarrow \frac{\partial}{\partial \theta} \int p(x | \theta) dx = 0 \\\\
                &\Longrightarrow \int \Big[\frac{\partial}{\partial \theta} \log p(x | \theta)\Big] p(x | \theta) dx = 0  \tag{1} \\\\
                &\Longrightarrow \mathbb{E }[s(\theta)] = 0
                \end{align*}
                \]
                where \(\frac{\partial}{\partial \theta} \log p(x | \theta) = s(\theta)\).
                <br><br>
                Taking derivatives of Equation (1), by the product rule, we obtain 
                \[
                \begin{align*}
                0 &= \frac{\partial}{\partial \theta} \int \Big[\frac{\partial}{\partial \theta} \log p(x | \theta)\Big] p(x | \theta) dx \\\\
                  &= \int \Big[\frac{\partial^2}{\partial \theta^2} \log p(x | \theta)\Big] p(x | \theta) dx 
                        + \int \Big[\frac{\partial}{\partial \theta} \log p(x | \theta)\Big] \frac{\partial}{\partial \theta} p(x | \theta) dx  \\\\
                  &= \int \Big[\frac{\partial^2}{\partial \theta^2} \log p(x | \theta)\Big] p(x | \theta) dx 
                     + \int \Big[\frac{\partial}{\partial \theta} \log p(x | \theta)\Big]^2 p(x | \theta) dx.  \\\\
                \end{align*}
                \]
                Therefore, 
                \[
                 - \mathbb{E }_{x \sim \theta } \Big[\frac{\partial^2}{\partial \theta^2} \log p(x | \theta)\Big] 
                    = \mathbb{E }_{x \sim \theta } \Big[ \Big(\frac{\partial}{\partial \theta} \log p(x | \theta)\Big)^2 \Big].
                \]
            </div>
        </blockquote>

        <h1>FIM for the Exponential Family</h1>
        <blockquote>
            Consider an <a href="expfamily.html">exponential family</a> distribution with natural parameter vector \(\eta \in \mathbb{R}^K\):
            \[
            p(x | \eta) = h(x) \exp \{\eta^\top \mathcal{T}(x) - A(\eta)\}.
            \]
            Remember that the gradient of the <strong>log partition function</strong> \(A(\eta)\) is the 
            expected <strong>sufficient statistics</strong> \(\mathcal{T}(\eta)\), which is called the moment parameters \(m\): 
            \[
            \nabla_{\eta} A(\eta) = \mathbb{E }[\mathcal{T}(\eta)] = m.
            \]
            Also, the gradient of the log likelihood is the sufficient statistics minus their expected value: 
            \[
            \begin{align*}
            &\log p(x | \eta) = \log h(x) + \eta^\top \mathcal{T}(x) - A(\eta) \\\\
            &\Longrightarrow \nabla_{\eta} \log p(x | \eta) = \mathcal{T}(x) - \mathbb{E }[\mathcal{T}(x)] = \mathcal{T}(x) - m.
            \end{align*}
            \]
            Therefore, the Hessian of the log partition function is the same as the FIM, which is the same as the
            covariance of the sufficient statistics: 
            \[
            \begin{align*}
            F(\eta) &= - \mathbb{E }_{p(x|\eta)} \Big[\nabla_{\eta}^2 (\eta^\top \mathcal{T}(x) - A(\eta))\Big] \\\\
                    &= \nabla_{\eta}^2 A(\eta) \\\\
                    &= \text{Cov }[\mathcal{T}(x)].
            \end{align*}
            \]
            So, the FIM is indeed the <strong>second cumulant</strong> of the sufficient statistics. 
            <br>
            Note: Sometimes, we need FIM with respect to the moment parameters \(m\): 
            \[
            m = \nabla_{\eta} A(\eta) \Longrightarrow \frac {dm}{d\eta} = \nabla_{\eta}^2 A(\eta) = F(\eta)
            \] 
            Here, \(F(\eta)\) is the Jacobian matrix and thus:
            \[
            F(m) = \frac{d\eta}{dm} = \Big(\frac{dm}{d\eta}\Big)^{-1} = F(\eta)^{-1}.
            \]
        </blockquote>

        <h1>Natural Gradient Descent</h1>
        <blockquote>
            The <strong>natural gradient descent (NGD)</strong> is the second order optimization method for the parameters 
            of (conditional) probability distributions \(p_{\theta}(y | x)\). 
            <br>
            (Also, check: <a href="../Calculus/gradient.html">Gradient Descent</a> for basic ideas.)
            <br><br>
            In NGD, we measure the difference between two probability distributions by the <a href="entropy.html"><strong>KL divergence</strong></a>.
            For any inputs \(x \in \mathbb{R}^n\), we can approximate the KL divergence in terms of the FIM: 
            \[
            D_{\mathbb{KL}}(p_{\theta}(y | x) \, \| \, p_{\theta + \delta} (y|x)) \approx \frac{1}{2}\delta^\top F_x \delta
            \]
            where \(F_x\) is the FIM: 
            \[
            F_x (\theta) = - \mathbb{E }_{p_{\theta}(y | x)} [\nabla^2 \log p_{\theta}(y|x)].
            \]
            <br>
            We compute average KL divergence between updated distribution and previous one using 
            \[
            \frac{1}{2}\delta^\top F (\theta) \delta
            \]
            where 
            \[
            F(\theta) = \mathbb{E }_{p\mathcal{D}(x)}[F_x(\theta)].
            \]
            In NGD, we use the inverse FIM as a preconditioning matrix:
            \[
            \theta_{t+1} = \theta_{t} - \eta_{t} F(\theta)^{-1} \nabla \mathcal{L}(\theta_t)
            \]
            Here, we define the <strong>natural gradient</strong>:
            \[
            \widetilde{\nabla} \mathcal{L}(\theta_t) = F(\theta)^{-1} \nabla \mathcal{L}(\theta_t).
            \]
            Note: \(F\) is always positive definite and it is easy to be approximated. This is a huge advantage using \(F\) for 
            a preconditioning matrix rather than the Hessian. 
            

        </blockquote>

        <a href="../../index.html">Back to Home </a>
        <br> <a href="probability.html">Back to Probability </a>   
    </body>
</html>