<!DOCTYPE html>
<html>
    <head> 
        <title>Bayesian Statistics</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <link rel="stylesheet" href="../styles.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body> 
        <h1>Bayesian inference</h1>
        <blockquote>
            The core of statistics is inferring the unknown parameters \(\theta\) given observed data \(\mathcal{D} = \{x_1, x_2, \cdots, x_n\}\), 
            which are random samples drawn from a probability distribution. This process is the inverse of probability theory. There are two main 
            approaches. One is called <strong>frequentist statistics</strong> which many people are familiar with, treats parameters as fixed and data as 
            random. The other is called <strong>Bayesian statistics</strong> which is the foundation for machine learning algorithms.
            <br><br>
            In Bayesian statistics, we assume that prior knowledge about the unknown parameters can be explained by a probability 
            distribution, which is called <strong>prior distribution</strong>, \(p(\theta)\). This means that the unknown parameters \(\theta\) are 
            treated as <strong>random variables</strong>, while the data \(\mathcal{D}\) are considered fixed. This approach is opposite 
            to that of frequentist statistics, where parameters are fixed and data are considered random. 
            <br><br>
            Bayesian inference updates our belief(= prior distribution) by using the observed data and
            expresses our updated belief about the parameters as the <strong>posterior distribution</strong>, \(p(\theta | \mathcal{D})\) 
            using Bayes' rule:
            \[
            \begin{align*}
            p(\theta | \mathcal{D}) &= \frac{p(\theta)p(\mathcal{D}| \theta)}{p(\mathcal{D})} \\\\
                                    &= \frac{p(\theta)p(\mathcal{D}| \theta)}{\int p(\theta ')p(\mathcal{D} | \theta ') \, d\theta '}
            \end{align*}
            \]
            The components are defined as follows:
            <ol>
                <li><strong>Prior distribution</strong> \(p(\theta)\):</li> 
                Represents our belief about the parameters \(\theta\) before observing any data. 
                It encodes prior knowledge, assumptions, or uncertainty about \(\theta\).
                <li><strong>Likelihood</strong> \(p(\mathcal{D}| \theta)\):</li>
                Describes how likely the observed data \(\mathcal{D}\) is, given a specific value of \(\theta\). 
                This reflects the model of the data-generating process.
                <li><strong>Marginal likelihood</strong>(or <strong>evidence</strong>) \(p(\mathcal{D})\): </li>
                A normalization constant that ensures the posterior is a valid probability distribution. 
                It is computed by integrating over all possible values of \(\theta\):  
                \[
                p(\mathcal{D}) = \int p(\theta')p(\mathcal{D} | \theta') \, d\theta'.
                \]
                Note: In the integral for the marginal likelihood, we use \(\theta'\) instead of \(\theta\) to clarify that 
                the integration is over the entire parameter space, not a specific parameter. 
            </ol>
            
        </blockquote>

        <h1>Conjugate Prior</h1>
        <blockquote>
            In general, specifying a prior is a bottleneck of the Bayesian inference. Here, we introduce some special case of priors.
            <br><br>
            A prior \(p(\theta) \in \mathcal{F}\) is saied to be <strong>conjugate prior</strong> for a likelihood function \(p(\mathcal{D} | \theta)\) if 
            the posterior is in the same parameterized family as the prior: \(p(\mathcal{D} | \theta) \in \mathcal{F}\). 

            <div class="proof">
                <span class="proof-title">Example: Beta-Binomial Model</span>
                Consider tossing a coin \(N\) times. Let \(\theta \in [0, 1]\) be a chance of getting head. We record the outcomes as 
                \(\mathcal{D} = \{y_n \in \{0, 1\} : n = 1 : N\}\). We assume the data are iid.
                <br><br>
                If we consider a sequence of coin tosses, the <strong>likelihood</strong> can be written as the Bernoulli likelihood model: 
                \[
                p(\mathcal{D} | \theta) = \prod_{n = 1}^N \theta^{y_n}(1 - \theta)^{1-y_n} = \theta^{N_1}(1 - \theta)^{N_0}
                \]
                where \(N_1\) and \(N_0\) are the number of heads and tails respectively. (Sample size: \(N_1 + N_0 = N\))
                <br><br>
                Alternatively, we can consider the Binomial likelihood model: 
                The likelihood has the following form:
                \[
                p(\mathcal{D} | \theta) = \text{Bin } (y | N, \theta) = \begin{pmatrix} N \\ y \end{pmatrix} \theta^y (1 - \theta)^{N - y} \propto  \theta^y (1 - \theta)^{N - y}
                \]
                where \(y\) is the number of heads.
                <br><br>
                Next, we have to specify a <strong>prior</strong>. If we have no idea about the parameter, <strong>uninformative prior</strong> can 
                be used:
                \[
                p(\theta) = \text{Unif }(\theta | 0, 1).
                \]
                However, "in this example", using beta distribution, we can represent the prior as follows:
                \[
                p(\theta) = \text{Beta }(\theta | a, b) = \frac{\Gamma(a+b)}{\Gamma(a)\Gamma(b)}\theta^{a-1}(1-\theta)^{b-1} \propto \theta^{a-1}(1-\theta)^{b-1}
                \]
                where \(a, b > 0\) are usually called hyper-parameters.(Our main parameter is \(\theta\).)
                <br>
                Note: If \(a = b = 1\), we get the uniformative prior. 
                <br><br>
                Using Bayes' rule, the <strong>posterior</strong> is proportional to the product of the likelihood and the prior:
                \[
                p(\theta | \mathcal{D}) \propto [\theta^{y}(1 - \theta)^{N-y}] \cdot [\theta^{a-1}(1-\theta)^{b-1}] \propto \text{Beta }(\theta | a+y, \, b+N-y). 
                \]
                Here, the posterior has the same functional form of as the prior. Thus, the beta distribution is the <strong>conjugate prior</strong> for the 
                binomial distribution. 
                <br><br>
                Once we got the posterior distribution, for example, we can use <strong>posterior mean</strong>, \(\bar{\theta}\) as a point estimate of \(\theta\):
                \[
                \bar{\theta} = \mathbb{E }[\theta | \mathcal{D}] = \frac{a+y}{(a+y) + (b+N-y)} = \frac{a+y}{a+b+N}.
                \]
                Note: 
                By adjusting hyper-parameters \(a\) and \(b\), we can control the influence of the prior on the posterior.
                <br>
                If \(a\) and \(b\) are small, the posterior mean will closely reflect the data: 
                \[
                \bar{\theta} \approx  \frac{y}{N} = \hat{\theta}_{MLE}
                \]
                while if \(a\) and \(b\) are large, the posterior mean will be more influenced by the prior.
                <br><br>
                Often we need to check the <strong>standard error</strong> of our estimate, which is the posterior standard deviation:
                \[
                \begin{align*}
                \text{SE }(\theta) &= \sqrt{\text{Var }[\theta | \mathcal{D}]} \\\\
                                   &= \sqrt{\frac{(a+y)(b+N-y)}{(a+b+N)^2(a+b+N+1)}}
                \end{align*}
                \]
                Here, if \(N \gg a, b\), we can simplify the <strong>posterior variance</strong> as follows:
                \[
                \begin{align*}
                \text{Var }[\theta | \mathcal{D}] &\approx \frac{y(N-y)}{(N)^2 N} \\\\
                                                  &= \frac{y}{N^2} - \frac{y^2}{N^3} \\\\
                                                  &= \frac{\hat{\theta}(1 - \hat{\theta})}{N}
                \end{align*}
                \]
                where \(\hat{\theta} = \frac{y}{N}\) is the MLE.
                <br><br>
                Thus, the standard error is given by 
                \[
                \text{SE }(\theta) \approx \sqrt{\frac{\hat{\theta}(1 - \hat{\theta})}{N}}.
                \]

            </div>

        </blockquote>

        <h1></h1>
        <blockquote>
        </blockquote>

        <br><a href="../../index.html">Back to Home </a>
        <br> <a href="probability.html">Back to Probability </a>   
    </body>
</html>