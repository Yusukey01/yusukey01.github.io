<!DOCTYPE html>
<html>
    <head> 
        <title>Bayesian Statistics 2</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <link rel="stylesheet" href="../styles.css">
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body> 
        <h1>The Exponential Family</h1>
        <blockquote>
            Actually, all members of the <strong>exponentil family</strong> have a conjugate prior. Before diving into Bayesian 
            statistics deeper, we discuss this important family of distributions. 
            <br><br>
            The exponential family is a family of probability distributions parameterized by 
            <strong>natural parameters</strong>(or <strong>canonical parameters</strong>) \(\eta \in \mathbb{R}^K\) with 
            support over \(\mathcal{X}^D \subseteq \mathbb{R}^D\) such that 
            \[
            \begin{align*}
            p(x | \eta ) &= \frac{1}{Z(\eta)} h(x) \exp\{\eta^T \mathcal{T}(x)\}\\\\
                         &= h(x) \exp\{\eta^T \mathcal{T}(x) - A(\eta)\}
            \end{align*}
            \]
            where 
            <ul>
                <li>\(h(x)\) is a <strong>base measure</strong>, which is a scaling constant, often 1.</li>
                <li>\(\mathcal{T}(x) \in \mathbb{R}^K\) is <strong>sufficient statistics</strong>.</li>
                <li>\(Z(\eta)\) is a normalization constant (or <strong>partition function</strong>) and \( A(\eta) = \log Z(\eta) \).</li>
            </ul>
            Each exponential family is defined by different \(h(x)\) and \(\mathcal{T}(x)\).
            <br>
            Note: the <strong>log partition function</strong> is convex over the convex set \(\Omega = \{\eta \in \mathbb{R}^K : A(\eta) < \infty\}\).
            <br><br>
            An exponential family is said to be <strong>minimal</strong> if there is no \(\eta \in \mathbb{R}^K \\ \{0\}\) such that 
            \[
            \eta^T\mathcal{T}(x) = 0.
            \]
            This means that the natural parameters are independent of each other. This condition can be violated in the case of multinomial distributions, 
            but we can reparameterize the distribution using \(K-1\) independent parameters. 
            <br><br>
            Let \(\eta = f(\phi)\), where \(\phi\) is some other possibly smaller set of parameters, and then 
            \[
            p(x | \phi ) = h(x) \exp\{ f(\phi)^T \mathcal{T}(x) - A(f(\phi))\}.
            \]
            If the mapping \(\phi \to \eta\) is nonlinear, it is said to be a <strong>curved exponential family</strong>.
            <br>
            If \(\eta = f(\phi) = \phi\), the model is in <strong>canonical form</strong> and in addition, if \(\mathcal{T} =x\), 
            we call it a <strong>natural exponential family(NEF)</strong>: 
            \[
            p(x | \eta ) =  h(x) \exp\{\eta^T x - A(\eta)\}.
            \]
            Finally, we define the <strong>moment parameters</strong> as follows:
            \[
            m = \mathbb{E }[\mathcal{T}(x)] \in \mathbb{R}^K.
            \]
            <div class="proof">
                <span class="proof-title">Example 1: Binomial distribution</span>
                \[
                \begin{align*}
                \text{Ber }(x | \mu) &= \mu^x (1-\mu)^{1-x} \\\\
                                     &= \exp\{x \log (\mu) + (1-x) \log (1-\mu)\}\\\\
                                     &= \exp\{\mathcal{T}(x)^T \eta\}
                \end{align*}
                \]
                where 
                <ul>
                    <li>\(\mathcal{T}(x) = [\mathbb{I}(x=1), \, \mathbb{I}(x=0)]\).</li>
                    <li>\(\eta = [\log(\mu), \, \log(1-\mu)]\).</li>
                    <li>\(\mu\) is the mean parameter.</li>
                </ul>
                In this representation, there is a linear dependence between the features, and then we cannot define 
                \(\eta\) uniquely. It is common to use a <strong>minimal representation</strong> so that there is a unique 
                \(\eta\) associated with the distribution.
                \[
                \text{Ber }(x | \mu) = \exp\Big\{x \log \Big(\frac{\mu}{1-\mu}\Big) + \log (1-\mu)\Big\}
                \]
                where 
                <ul>
                    <li>\(\mathcal{T}(x) = x\).</li>
                    <li>\(\eta = \log \Big(\frac{\mu}{1-\mu}\Big)\).</li>
                    <li>\(A(\eta) = -\log (1-\mu) = \log(1+ e^{\eta})\).</li>
                    <li>\(h(x) = 1\).</li>
                </ul>
                Note: the mean parameter \(\mu\) can be recovered from \(\eta\) via a logistic function: 
                \[
                \mu = \sigma(\eta) = \frac{1}{1+e^{-\eta}}.
                \]
            </div>

            <div class="proof">
                <span class="proof-title">Example 2: Normal distribution</span>
                \[
                \begin{align*}
                N(x | \mu, \, \sigma^2) &= \frac{1}{\sigma\sqrt{2\pi}}\exp\Big\{-\frac{1}{2\sigma^2}(x - \mu)^2\Big\} \\\\
                                        &= \frac{1}{\sqrt{2\pi}}
                                            \exp\Big\{ \frac{\mu}{\sigma^2}x - \frac{1}{2\sigma^2}x^2 -\frac{1}{2\sigma^2}\mu^2 -\log \sigma\Big\}
                \end{align*}
                \]
                where
                <ul>
                    <li>\(\mathcal{T}(x) = \begin{bmatrix}x \\ x^2 \end{bmatrix}\)</li>
                    <li>\(\eta = \begin{bmatrix} \frac{\mu}{\sigma^2} \\ -\frac{1}{2\sigma^2} \end{bmatrix} \)</li>
                    <li>\(A(\eta) = \frac{\mu^2}{2\sigma^2}+\log \sigma = -\frac{\eta_1^2}{4\eta_2}-\frac{1}{2}\log(-2\eta_2)\)</li>
                    <li>\(h(x) = \frac{1}{\sqrt{2\pi}}\).</li>
                </ul>
                ALso, the moment parameters are given by:
                \[
                m = \begin{bmatrix} \mu \\ \mu^2 + \sigma^2 \end{bmatrix}
                \]
                Note: If \(\sigma = 1\), the distribution becomes a natural exponential family such that 
                <ul>
                    <li>\(\mathcal{T}(x) = x\)</li>
                    <li>\(\eta = \mu\)</li>
                    <li>\(A(\eta) = \frac{\mu^2}{2\sigma^2}+\log \sigma = \frac{\mu^2}{2}\)</li>
                    <li>\(h(x) = \frac{1}{\sqrt{2\pi}}\exp\{-\frac{x^2}{2}\} = N(x | 0, 1)\) : Not constant.</li>
                </ul>
            </div>
            <div class="proof">
                <span class="proof-title">Example 3: Multivariate Normal distribution</span>
                \[
                \begin{align*}
                N(x | \mu, \Sigma) &= \frac{1}{(2\pi)^{\frac{D}{2}}\sqrt{\det(\Sigma)}}
                                     \exp\Big\{ \frac{1}{2}x^T\Sigma^{-1}x + x^T\Sigma^{-1}\mu -\frac{1}{2}\mu^T\Sigma^{-1}\mu \Big\}\\\\
                                   &= c \exp\Big\{x^T\Sigma^{-1}\mu -\frac{1}{2}x^T\Sigma^{-1}x \Big\}
                \end{align*}
                \]
                where 
                \[
                c = \frac{\exp\Big\{-\frac{1}{2}\mu^T \Sigma^{-1} \mu\Big\}}{(2\pi)^{\frac{D}{2}}\sqrt{\det(\Sigma)}}.
                \]
            </div>
        </blockquote> 

        <h1> </h1>
        <blockquote>

        </blockquote>

<br><a href="../../index.html">Back to Home </a>
<br> <a href="probability.html">Back to Probability </a>   
</body>
</html>