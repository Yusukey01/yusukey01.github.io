<!DOCTYPE html>
<html>
    <head> 
        <title>Woodbury</title>
        <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
        <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
        <link rel="stylesheet" href="../styles.css"> 
        <meta name="viewport" content="width=device-width, initial-scale=1">
    </head>
    <body> 
        <h1>Woodbury matrix Identity</h1>
        <blockquote>
            <div class="theorem">
            <span class="theorem-title">Theorem 1: Woodbury matrix identity</span>   
            \[
            (A + BDC)^{-1} = A^{-1} - A^{-1} B (D^{-1} + CA^{-1}B)^{-1} CA^{-1}
            \]
            where \(A \in \mathbb{R}^{n \times n}\), \(B \in \mathbb{R}^{n \times k}\), 
            \(C \in \mathbb{R}^{k \times n}\), and \(D \in \mathbb{R}^{k \times k}\). 
        </div>
        Note: In the case where \(k << n\), this is much cheaper than computing \((A + BDC)^{-1}\) directly. 
        <div class="proof">
            <span class="proof-title">Proof:</span>
            \[
            \begin{align*}
            &(A + BDC)\{A^{-1} - A^{-1} B (D^{-1} + CA^{-1}B)^{-1} CA^{-1}\} \\\\
            &= I + BDCA^{-1} -B(D^{-1} + CA^{-1}B)^{-1}CA^{-1} -BDCA^{-1}B(D^{-1} + CA^{-1}B)^{-1}CA^{-1}\\\\
            &= I + BDCA^{-1} -B \{(D^{-1} + CA^{-1}B)^{-1} - DCA^{-1}B(D^{-1} + CA^{-1}B)^{-1}\}CA^{-1} \\\\
            &= I + BDCA^{-1} -B \{(I - DCA^{-1}B)(D^{-1} + CA^{-1}B)^{-1}\}CA^{-1} \\\\
            &= I + BDCA^{-1} -B \{(DD^{-1} - DCA^{-1}B)(D^{-1} + CA^{-1}B)^{-1}\}CA^{-1} \\\\
            &= I + BDCA^{-1} -BD \{(D^{-1} - CA^{-1}B)(D^{-1} + CA^{-1}B)^{-1}\}CA^{-1} \\\\
            &= I + BDCA^{-1} -BDCA^{-1} \\\\
            &= I 
            \end{align*}
            \]
        </div>
        In addition, when \(k = 1\), we obtain <strong>Sherman-Morrison formula</strong>.
        <div class="theorem">
            <span class="theorem-title">Theorem 2: Sherman-Morrison formula</span> 
            Suppose \(A \in \mathbb{R}^{n \times n}\) is invertible, and \(u, v \in \mathbb{R}^n\).
            Then \((A + uv^T)\) is invertible if and only if \(1 + v^T A^{-1} u \neq 0\). In this case, 
            \[
            (A + uv^T)^{-1} = A^{-1} - \frac{A^{-1} uv^T A^{-1}}{1 + v^T A^{-1} u}.
            \]
        </div>

        </blockquote>

            <a href="../../index.html">Back to Home </a>
        <br> <a href="linear_algebra.html">Back to Linear Algebra </a>
    </body>
</html>