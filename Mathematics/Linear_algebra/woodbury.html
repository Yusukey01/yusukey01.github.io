---
layout: default
title: Woodbury Matrix Identity
topic_id: linalg-12
level: detail
uses_math: true
uses_python: false
---
<!DOCTYPE html>
<html>
    <body>
        {% include learning_resource_schema.html topic_id=page.topic_id %}
       
        <div class="hero-section">
            <h1 class="webpage-name">Woodbury Matrix Identity
            </h1>
        </div>

        {% include section_navigation.html %}

        <div class="topic-nav">
            <a href="#wmi">Woodbury Matrix Identity</a>
        </div> 

        <div class="container">  
           
            <section id="wmi" class="section-content">
            <h2>Woodbury Matrix Identity</h2>
            <p>
            <div class="theorem">
            <span class="theorem-title">Theorem 1: Woodbury matrix identity</span>   
            \[
            (A + UBV)^{-1} = A^{-1} - A^{-1} U (B^{-1} + VA^{-1}U)^{-1} VA^{-1}
            \]
            where \(A \in \mathbb{R}^{n \times n}\), \(U \in \mathbb{R}^{n \times k}\), 
            \(V \in \mathbb{R}^{k \times n}\), and \(B \in \mathbb{R}^{k \times k}\). 
            </div>
            <div class="proof">
            <span class="proof-title">Proof:</span>
            \[
            \begin{align*}
            &(A + UBV)\{A^{-1} - A^{-1} U (B^{-1} + VA^{-1}U)^{-1} VA^{-1}\} \\\\
            &= I + UBVA^{-1} -U(B^{-1} + VA^{-1}U)^{-1}VA^{-1} -UBVA^{-1}U(B^{-1} + VA^{-1}U)^{-1}VA^{-1}\\\\
            &= I + UBVA^{-1} -U \{(B^{-1} + VA^{-1}U)^{-1} + BVA^{-1}U(B^{-1} + VA^{-1}U)^{-1}\}VA^{-1} \\\\
            &= I + UBVA^{-1} -U \{(I + BVA^{-1}U)(B^{-1} + VA^{-1}U)^{-1}\}VA^{-1} \\\\
            &= I + UBVA^{-1} -U \{(BB^{-1} + BVA^{-1}U)(B^{-1} + VA^{-1}U)^{-1}\}VA^{-1} \\\\
            &= I + UBVA^{-1} -UB \{(B^{-1} + VA^{-1}U)(B^{-1} + VA^{-1}U)^{-1}\}VA^{-1} \\\\
            &= I + UBVA^{-1} -UBVA^{-1} \\\\
            &= I 
            \end{align*}
            \]
            </div>
            In addition, when \(k = 1\), \(U\) and \(V\) are just vectors, then we obtain <strong>Sherman-Morrison formula</strong>.
            <div class="theorem">
                <span class="theorem-title">Theorem 2: Sherman-Morrison formula</span> 
                Suppose \(A \in \mathbb{R}^{n \times n}\) is invertible, and \(u, v \in \mathbb{R}^n\).
                Then \((A + uv^T)\) is invertible if and only if \(1 + v^T A^{-1} u \neq 0\). In this case, 
                \[
                (A + uv^T)^{-1} = A^{-1} - \frac{A^{-1} uv^T A^{-1}}{1 + v^T A^{-1} u}.
                \]
                Note:
                \[
                (A - uv^T)^{-1} = A^{-1} + \frac{A^{-1} uv^T A^{-1}}{1 - v^T A^{-1} u}.
                \]
            </div>
            <div class="proof">
                <span class="proof-title">Proof:</span>
                To show that the Sherman-Morrison formula is a special case of the Woodbury matrix identity, 
                we set the parameters as follows for a rank-1 update:
                <ul style="padding-left: 40px;">
                    <li>\(k = 1\) (rank-1 update)</li>
                    <li>\(U = u \in \mathbb{R}^{n \times 1}\) (column vector)</li>
                    <li>\(V = v^T \in \mathbb{R}^{1 \times n}\) (row vector)</li>
                    <li>\(B = 1 \in \mathbb{R}^{1 \times 1}\) (scalar identity)</li>
                </ul>
                
                With these substitutions:
                \[
                \begin{align*}
                UBV &= u \cdot 1 \cdot v^T = uv^T \\\\
                B^{-1} &= 1^{-1} = 1 \\\\
                VA^{-1}U &= v^T A^{-1} u \quad \text{(scalar)}
                \end{align*}
                \]
                
                Substituting into the Woodbury identity:
                \[
                \begin{align*}
                (A + UBV)^{-1} &= A^{-1} - A^{-1} U (B^{-1} + VA^{-1}U)^{-1} VA^{-1} \\\\
                (A + uv^T)^{-1} &= A^{-1} - A^{-1} u (1 + v^T A^{-1} u)^{-1} v^T A^{-1} \\\\
                                &= A^{-1} - A^{-1} u \cdot \frac{1}{1 + v^T A^{-1} u} \cdot v^T A^{-1} \\\\
                                &= A^{-1} - \frac{A^{-1} u v^T A^{-1}}{1 + v^T A^{-1} u}
                \end{align*}
                \]
                
                This is precisely the Sherman-Morrison formula.
            </div>
            </p>
            </section>
        </div>
        <script src="/js/main.js"></script>
    </body>
</html>