/**
 * MATH–CS COMPASS
 * Clean, mathematically correct visualization of algebraic structure hierarchy.
 *
 * Correct chain:
 * Euclidean ⊂ PID ⊂ UFD ⊂ Integral Domain ⊂ Ring ⊂ Group
 *
 * Field is NOT part of this chain.
 */

const renderAlgebraCompass = () => {
  const root = document.getElementById("algebra-map-root");
  if (!root) return;

  const structures = [
    { name: "Group", r: 260, desc: "A set with one operation and inverses.", ex: "Sₙ, (ℤ, +)" },
    { name: "Ring", r: 220, desc: "Two operations: addition and multiplication.", ex: "Mₙ(ℝ), ℤ[x]" },
    { name: "Integral Domain", r: 180, desc: "Commutative ring with no zero divisors.", ex: "ℤ, ℤ[√-5]" },
    { name: "UFD", r: 140, desc: "Unique factorization into irreducibles.", ex: "ℤ[x]" },
    { name: "PID", r: 100, desc: "Every ideal is generated by one element.", ex: "ℤ, ℚ[x]" },
    { name: "Euclidean Domain", r: 60, desc: "Division algorithm exists (gcd works).", ex: "ℤ, ℤ[i]" }
  ];

  const colors = [
    "#dbeafe",
    "#bfdbfe",
    "#93c5fd",
    "#60a5fa",
    "#3b82f6",
    "#2563eb"
  ];

  root.innerHTML = `
    <style>
      .ring {
        fill: none;
        stroke-width: 18;
        cursor: pointer;
        transition: stroke-width 0.2s ease, opacity 0.2s ease;
        opacity: 0.85;
      }
      .ring:hover {
        stroke-width: 26;
        opacity: 1;
      }

      .label {
        font-family: system-ui, sans-serif;
        font-size: 13px;
        fill: #1e293b;
        font-weight: 600;
      }

      .center {
        font-family: system-ui, sans-serif;
        font-size: 12px;
        fill: #fff;
        font-weight: bold;
        text-anchor: middle;
      }

      #info-box {
        max-width: 460px;
        padding: 18px;
        margin-top: 14px;
        border-radius: 10px;
        background: #f8fafc;
        border-left: 5px solid #3b82f6;
        box-shadow: 0 2px 8px rgba(0,0,0,0.05);
      }
    </style>

    <svg viewBox="0 0 600 600" style="max-width:520px;width:100%;height:auto;">
      ${structures.map((s, i) => `
        <circle
          cx="300" cy="300" r="${s.r}"
          stroke="${colors[i]}"
          class="ring"
          data-name="${s.name}">
        </circle>

        <text x="${300 + s.r + 10}" y="305" class="label">
          ${s.name}
        </text>
      `).join("")}

      <!-- Field (separate structure) -->
      <circle cx="300" cy="300" r="26" fill="#22c55e"></circle>
      <text x="300" y="305" class="center">Field</text>
    </svg>

    <div id="info-box">
      <h3 id="info-name" style="margin:0 0 8px 0;">Algebraic Hierarchy</h3>
      <p id="info-desc" style="margin:0 0 8px 0;">
        Hover over a ring to explore the algebraic structure chain.
      </p>
      <p id="info-ex" style="margin:0;font-size:0.85em;color:#475569;"></p>
    </div>
  `;

  const nameEl = document.getElementById("info-name");
  const descEl = document.getElementById("info-desc");
  const exEl = document.getElementById("info-ex");

  root.querySelectorAll(".ring").forEach(ring => {
    ring.addEventListener("mouseenter", () => {
      const name = ring.dataset.name;
      const data = structures.find(s => s.name === name);
      nameEl.textContent = data.name;
      descEl.textContent = data.desc;
      exEl.textContent = `Example: ${data.ex}`;
    });
  });
};

// Auto-start
if (document.readyState === "loading") {
  document.addEventListener("DOMContentLoaded", renderAlgebraCompass);
} else {
  renderAlgebraCompass();
}
