/* ========== MATH-CS COMPASS: DARK THEME ENHANCEMENT ==========
 * Unifies the visual language between the compass map and main pages
 * 
 * Features:
 * - Dark atmospheric backgrounds (no more jarring white)
 * - Section-specific colors matching the knowledge map
 * - Glassmorphism effects for content containers
 * - Consistent visual depth and glow effects
 * 
 * Section Colors (from compass map):
 * I  - Linear Algebra:    #1565c0 (Deep Blue)
 * II - Calculus:          #2e7d32 (Forest Green)
 * III - Probability:      #00838f (Teal/Cyan)
 * IV - Discrete:          #6a1b9a (Deep Purple)
 * V  - Machine Learning:  #ef6c00 (Vibrant Orange)
 * ============================================================ */

/* ========== CSS VARIABLES EXTENSION ========== */
:root {
    /* Section Colors */
    --section-i-color: #1565c0;
    --section-i-light: #42a5f5;
    --section-i-glow: rgba(21, 101, 192, 0.4);
    
    --section-ii-color: #2e7d32;
    --section-ii-light: #66bb6a;
    --section-ii-glow: rgba(46, 125, 50, 0.4);
    
    --section-iii-color: #00838f;
    --section-iii-light: #26c6da;
    --section-iii-glow: rgba(0, 131, 143, 0.4);
    
    --section-iv-color: #6a1b9a;
    --section-iv-light: #ab47bc;
    --section-iv-glow: rgba(106, 27, 154, 0.4);
    
    --section-v-color: #ef6c00;
    --section-v-light: #ffa726;
    --section-v-glow: rgba(239, 108, 0, 0.4);
    
    /* Dark Theme Base */
    --dark-bg-primary: #0b0e14;
    --dark-bg-secondary: #0f1419;
    --dark-bg-tertiary: #151b24;
    --dark-bg-card: rgba(15, 20, 30, 0.7);
    --dark-border: rgba(255, 255, 255, 0.08);
    --dark-border-hover: rgba(255, 255, 255, 0.15);
    --dark-text-primary: #f1f5f9;
    --dark-text-secondary: rgba(255,255,255,0.85);
    --dark-text-muted: rgba(255, 255, 255, 0.5);
    
    /* Glassmorphism */
    --glass-bg: rgba(15, 20, 30, 0.6);
    --glass-bg-solid: rgba(20, 28, 40, 0.95);
    --glass-border: rgba(255, 255, 255, 0.1);
    --glass-shadow: 0 8px 32px rgba(0, 0, 0, 0.3);
}

/* ========== BODY & GLOBAL BACKGROUND ========== */
body {
    background: var(--dark-bg-primary);
    color: var(--dark-text-primary);
}

/* Ambient background effect - subtle radial glow */
body::before {
    content: '';
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    pointer-events: none;
    z-index: -1;
    background: 
        radial-gradient(ellipse at 20% 20%, rgba(21, 101, 192, 0.08) 0%, transparent 50%),
        radial-gradient(ellipse at 80% 30%, rgba(46, 125, 50, 0.06) 0%, transparent 45%),
        radial-gradient(ellipse at 70% 80%, rgba(106, 27, 154, 0.06) 0%, transparent 45%),
        radial-gradient(ellipse at 30% 70%, rgba(0, 131, 143, 0.06) 0%, transparent 45%),
        radial-gradient(ellipse at 50% 50%, rgba(239, 108, 0, 0.04) 0%, transparent 60%);
}

/* ========== MAIN CONTAINER ========== */
.container {
    background: transparent;
}

/* ========== CONTENT SECTIONS - GLASSMORPHISM ========== */

.nav-logo {
    width: 70px;
    height: 70px;
    object-fit: contain;
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    filter: drop-shadow(0 0 8px rgba(100, 180, 255, 0.3));
}

.logo-link:hover .nav-logo {
    transform: rotate(15deg) scale(1.2);
    filter: drop-shadow(0 0 15px rgba(100, 180, 255, 0.6));
}

.logo-home {
    display: flex;
    align-items: center;
}

.logo-link {
    display: flex;
    align-items: center;
    padding: 5px;
    border-radius: 50%;
    transition: background 0.3s ease;
}

.logo-link:hover {
    background: rgba(100, 180, 255, 0.1);
}

/* ========== EXPLORE TOPICS - COMPASS/STAR LAYOUT (PC, Homepage Only) ========== */
@media (min-width: 1200px) {
    .topic-cards.homepage-explore {
        display: grid;
        grid-template-columns: repeat(3, 1fr);
        grid-template-rows: repeat(6, auto); 
        gap: var(--spacing-lg);
        max-width: 1100px;
        margin: 0 auto;
        align-items: center;
    }

    /* Map card - center */
    .topic-cards.homepage-explore .card:first-child {
        grid-row: 3 / 5; 
        grid-column: 2;
    }

    /* Section I - top */
    .topic-cards.homepage-explore .card:nth-child(2) {
        grid-row: 1 / 3;
        grid-column: 2;
    }

    /* Section II & III  */
    .topic-cards.homepage-explore .card:nth-child(3) {
        grid-row: 2 / 4; 
        grid-column: 1;
    }
    .topic-cards.homepage-explore .card:nth-child(4) {
        grid-row: 2 / 4;
        grid-column: 3;
    }

    /* Section IV & V  */
    .topic-cards.homepage-explore .card:nth-child(5) {
        grid-row: 4 / 6;
        grid-column: 1;
    }
    .topic-cards.homepage-explore .card:nth-child(6) {
        grid-row: 4 / 6;
        grid-column: 3;
    }
}

/* Even larger screens - more spacing (Homepage Only) */
@media (min-width: 1600px) {
    .topic-cards.homepage-explore {
        max-width: 1300px;
        gap: var(--spacing-xl);
    }
}

/* ========== CONTENT SECTIONS - GLASSMORPHISM ========== */
.homepage-introduction,
.update-notice,
.content-sections,
.references {
    background: var(--glass-bg-solid);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-radius: 16px;
    box-shadow: 
        var(--glass-shadow),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    color: var(--dark-text-primary);
    padding: var(--spacing-lg);
    margin-bottom: var(--spacing-lg);
}

/* Ensure Explore Topics section has proper padding */
.content-sections {
    padding: var(--spacing-lg);
}

.homepage-introduction {
    border-left: 4px solid var(--primary-color);
}

.homepage-introduction h2 {
    color: var(--dark-text-primary);
    border-bottom-color: rgba(255, 255, 255, 0.2) !important;
}

.homepage-introduction p {
    color: var(--dark-text-secondary);
}

.homepage-introduction strong {
    color: var(--dark-text-primary);
}

/* Worlds overview box */
.worlds-overview {
    background: rgba(255, 255, 255, 0.03) !important;
    border-left-color: rgba(255, 255, 255, 0.3) !important;
}

.worlds-overview h4 {
    color: var(--dark-text-primary) !important;
}

/* ========== UPDATE NOTICE ========== */
.update-notice {
    border-left: 4px solid var(--accent-color);
}

.update-notice h2 {
    color: var(--dark-text-primary);
}

#update-log {
    background: rgba(0, 0, 0, 0.2);
    border-color: rgba(255, 255, 255, 0.1);
    color: var(--dark-text-secondary);
}

/* ========== SECTION HEADINGS ========== */
.content-sections h2,
.references h2 {
    color: var(--dark-text-primary);
}

h2::after {
    background: linear-gradient(to right, var(--primary-color), transparent);
}

/* ========== REFERENCES SECTION ========== */
.references h3 {
    color: var(--dark-text-primary);
}

.references ul {
    color: var(--dark-text-primary);
}

.references ul li {
    color: var(--dark-text-primary);
    opacity: 0.9;
}

.references a {
    color: #64b4ff;
}

.references a:hover {
    color: #a0c4ff;
}

.reference-column ul li {
    color: var(--dark-text-primary);
}

.reference-column li {
    color: var(--dark-text-primary);
}

.reference-column a {
    color: #64b4ff;
}

.reference-column a:hover {
    color: #a0c4ff;
}

/* ========== MAIN CONTENT AREA ========== */

.section-content {
    background: var(--glass-bg-solid);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-left: 5px solid var(--primary-color);
    border-radius: var(--border-radius-md);
    box-shadow: var(--glass-shadow);
    color: var(--dark-text-primary);
}

.section-content p,
.section-content li {
    color: var(--dark-text-secondary);
}

.section-content h1,
.section-content h2,
.section-content h3,
.section-content h4,
.section-content h5,
.section-content h6 {
    color: var(--dark-text-primary);
}

.section-content strong {
    color: var(--dark-text-primary);
    font-weight: 700;
}

/* ========== THEOREM BOX ========== */

.theorem {
    background: rgba(251, 146, 60, 0.05);
    border: 1px solid rgba(251, 146, 60, 0.15);
    border-left: 5px solid #d97706;
    color: var(--dark-text-primary);
    box-shadow: 0 4px 16px rgba(0, 0, 0, 0.2);
}

.theorem-title {
    color: #f59e0b;
    font-weight: 700;
    font-size: 1.05em;
    letter-spacing: 0.3px;
}

/* ========== PROOF BOX ========== */

.proof {
    background: rgba(74, 222, 128, 0.04);
    border: 1px dashed rgba(74, 222, 128, 0.25);
    border-left: 5px dashed #4ade80;
    color: var(--dark-text-primary);
}

.proof-title {
    color: rgba(134, 239, 172, 0.85);
    font-weight: 600;
    font-style: italic;
}

/* ========== INSIGHT BOX ========== */

.insight-box {
    background: linear-gradient(135deg, rgba(192, 132, 252, 0.08) 0%, rgba(192, 132, 252, 0.02) 100%);
    border: 2px solid rgba(192, 132, 252, 0.2);
    border-left: 5px double #c084fc;
    border-radius: 0 12px 12px 0;
    color: var(--dark-text-primary);
    box-shadow: 
        0 4px 20px rgba(0, 0, 0, 0.15),
        inset 0 1px 0 rgba(192, 132, 252, 0.1);
}

.insight-box h3 {
    color: #d8b4fe;
}

.insight-box p,
.insight-box li {
    color: var(--dark-text-secondary);
}

.insight-box strong {
    color: var(--dark-text-primary);
}

/* ========== PSEUDOCODE ========== */
.pseudocode {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-left: 4px solid rgba(255, 255, 255, 0.3);
    color: var(--dark-text-primary);
}

.pseudocode-title {
    color: var(--dark-text-primary);
}

/* ========== PYTHON CODE ========== */
.python-code {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    color: #e0e0e0;
}

.code-header {
    background: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.1);
}

.code-title {
    color: var(--dark-text-primary);
}

/* ========== PYTHON OUTPUT ========== */
.python-output {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-left: 4px solid rgba(255, 255, 255, 0.25);
    color: var(--dark-text-primary);
}

/* ========== CODE CONTAINER ========== */
.code-container {
    background: transparent;
}

/* ========== TOC CONTAINER ========== */
.toc-container {
    background: var(--glass-bg-solid);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    border-left: 4px solid rgba(255, 255, 255, 0.3);
    box-shadow: var(--glass-shadow);
}

.toc-container h2 {
    color: var(--dark-text-primary);
}

.toc-container a {
    color: var(--dark-text-secondary);
}

.toc-container a:hover {
    color: #64b4ff;
}

/* ========== TOPIC NAV ========== */
.topic-nav {
    background: var(--glass-bg-solid);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
}

.topic-nav a {
    background-color: rgba(255, 255, 255, 0.08);
    color: var(--dark-text-secondary);
}

.topic-nav a:hover {
    background-color: var(--primary-color);
    color: var(--text-light);
}

/* ========== COLLAPSIBLE SECTIONS ========== */
.collapsible-section {
    background: var(--glass-bg-solid);
    border: 1px solid var(--glass-border);
}

.collapsible-header {
    background: rgba(255, 255, 255, 0.05);
    color: var(--dark-text-primary);
}

.collapsible-header:hover {
    background: rgba(255, 255, 255, 0.1);
}

.collapsible-content {
    background: transparent;
    color: var(--dark-text-secondary);
}

/* ========== TABLES ========== */
table {
    background: rgba(255, 255, 255, 0.03);
    border-color: rgba(255, 255, 255, 0.1);
}

th {
    background: rgba(255, 255, 255, 0.08);
    color: var(--dark-text-primary);
    border-color: rgba(255, 255, 255, 0.15);
}

td {
    color: var(--dark-text-secondary);
    border-color: rgba(255, 255, 255, 0.1);
}

tr:hover {
    background: rgba(255, 255, 255, 0.05);
}

/* ========== INLINE CODE ========== */
code {
    background: rgba(255, 255, 255, 0.1);
    color: #c9d1d9;
    padding: 0.2em 0.4em;
    border-radius: 4px;
    font-size: 0.9em;
}

pre code {
    background: transparent;
    color: inherit;
    padding: 0;
}

/* ========== MATH TABLE ========== */
.math-table-title {
    color: var(--dark-text-primary);
}

.math-table-caption {
    color: var(--dark-text-muted);
}

/* ========== GENERAL TEXT ELEMENTS ========== */
p {
    color: var(--dark-text-secondary);
}

li {
    color: var(--dark-text-secondary);
}

strong {
    color: var(--dark-text-primary);
}

em {
    color: var(--dark-text-secondary);
}

/* Headings */
h1, h2, h3, h4, h5, h6 {
    color: var(--dark-text-primary);
}

/* ========== CONTAINER BACKGROUND ========== */
.container {
    background: transparent;
    color: var(--dark-text-primary);
}

/* ========== PC READABILITY IMPROVEMENTS ========== */

@media (min-width: 1200px) {
    .container {
        max-width: 1500px;
        padding: var(--spacing-lg) var(--spacing-xl);
    }
    
    .section-content {
        max-width: 1200px;
        margin-left: auto;
        margin-right: auto;
        font-size: 1.1rem;
        line-height: 1.95;
        padding: var(--spacing-xl);
    }
    
    .section-content p,
    .section-content li {
        font-size: 1.1rem;
        line-height: 1.95;
    }
    
    .section-content h2 {
        font-size: 1.8rem;
        margin-top: 2.5rem;
        margin-bottom: 1.2rem;
    }
    
    .section-content h3 {
        font-size: 1.4rem;
        margin-top: 2rem;
        margin-bottom: 1rem;
    }
    
    /* Theorem, proof, insight boxes */
    .theorem,
    .proof,
    .insight-box {
        font-size: 1.05rem;
        line-height: 1.8;
        padding: 1.8rem;
    }
    
    /* Code blocks */
    .pseudocode,
    .python-code,
    .python-output {
        font-size: 0.95rem;
        line-height: 1.6;
        padding: 1.5rem;
    }
}

/* Even wider on very large screens */
@media (min-width: 1600px) {
    .container {
        max-width: 1700px;
    }
    
    .section-content {
        max-width: 1350px;
        font-size: 1.15rem;
        line-height: 2;
    }
    
    .section-content p,
    .section-content li {
        line-height: 2;
        font-size: 1.15rem;
    }
    
    .section-content h2 {
        font-size: 2rem;
    }
    
    .section-content h3 {
        font-size: 1.5rem;
    }
}

/* Ultra-wide screens */
@media (min-width: 1920px) {
    .container {
        max-width: 1900px;
        padding: var(--spacing-xl) 4rem;
    }
    
    .section-content {
        max-width: 1500px;
        font-size: 1.2rem;
        padding: 3rem;
    }
    
    .section-content p,
    .section-content li {
        font-size: 1.2rem;
        line-height: 1.95;
    }
    
    .theorem,
    .proof,
    .insight-box {
        font-size: 1.1rem;
        padding: 2rem;
    }
}

/* ========== MERMAID DIAGRAM DARK THEME ========== */
.mermaid {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
    padding: var(--spacing-md);
}

/* Hide edge label backgrounds in Mermaid diagrams */
.mermaid .edgeLabel {
    background-color: transparent !important;
    background: transparent !important;
}

.mermaid .edgeLabel rect,
.mermaid .edgeLabel polygon {
    fill: transparent !important;
    stroke: none !important;
    opacity: 0 !important;
}

.mermaid .edgeLabel span,
.mermaid .edgeLabel p,
.mermaid .edgeLabel foreignObject {
    background: transparent !important;
    background-color: transparent !important;
}

/* Target the label background rect specifically */
.mermaid .labelBkg {
    fill: transparent !important;
    stroke: none !important;
    opacity: 0 !important;
}

/* Edge label text - make it blend or hide */
.mermaid .edgeLabel .label {
    background: transparent !important;
}

.mermaid .edgeLabel .label rect {
    fill: transparent !important;
    rx: 0;
    ry: 0;
    opacity: 0 !important;
}

/* Mermaid node text */
.mermaid .nodeLabel {
    color: var(--dark-text-primary);
}

/* Mermaid edges/links */
.mermaid .flowchart-link {
    stroke: rgba(255, 255, 255, 0.4) !important;
}

.mermaid path.flowchart-link {
    stroke: rgba(255, 255, 255, 0.4) !important;
}

/* Subgraph styling for dark theme */
.mermaid .cluster rect {
    fill: rgba(255, 255, 255, 0.03) !important;
    stroke: rgba(255, 255, 255, 0.2) !important;
}

.mermaid .cluster span {
    color: var(--dark-text-secondary) !important;
}

/* ========== TOPIC CARDS CONTAINER ========== */
.topic-cards {
    gap: var(--spacing-lg);
}

/* ========== BASE CARD DARK THEME ========== */
.card {
    background: var(--dark-bg-card);
    backdrop-filter: blur(12px);
    -webkit-backdrop-filter: blur(12px);
    border: 1px solid var(--dark-border);
    box-shadow: 
        0 4px 24px rgba(0, 0, 0, 0.3),
        inset 0 1px 0 rgba(255, 255, 255, 0.05);
    transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
}

.card::before {
    /* Reset the top accent line - will be customized per section */
    height: 4px;
    opacity: 0.8;
    transition: opacity 0.3s ease, height 0.3s ease;
}

.card:hover {
    transform: translateY(-8px);
    border-color: var(--dark-border-hover);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:hover::before {
    opacity: 1;
    height: 5px;
}

/* Card icon base */
.card-icon {
    color: var(--primary-color);
    text-shadow: 0 0 20px currentColor;
}

.card-icon::after {
    background: radial-gradient(circle, currentColor 0%, transparent 70%);
    opacity: 0.15;
}

.card:hover .card-icon::after {
    opacity: 0.25;
}

/* Card title */
.card h3 {
    color: var(--dark-text-primary);
}

.card h3 a {
    color: var(--dark-text-primary);
}

/* Card description */
.card p {
    color: var(--dark-text-muted);
}

/* ========== SECTION-SPECIFIC CARD STYLES ========== */

/* Section I - Linear Algebra (Deep Blue) */
.card:nth-child(2) {
    --card-section-color: var(--section-i-color);
    --card-section-light: var(--section-i-light);
    --card-section-glow: var(--section-i-glow);
}

.card:nth-child(2)::before {
    background: linear-gradient(90deg, 
        var(--section-i-color) 0%, 
        var(--section-i-light) 50%,
        var(--section-i-color) 100%
    );
}

.card:nth-child(2) .card-icon {
    color: var(--section-i-light);
}

.card:nth-child(2):hover {
    border-color: rgba(21, 101, 192, 0.4);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 30px var(--section-i-glow),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:nth-child(2):hover h3 a {
    color: var(--section-i-light);
    text-shadow: 0 0 10px var(--section-i-glow);
}

/* Section II - Calculus (Forest Green) */
.card:nth-child(3) {
    --card-section-color: var(--section-ii-color);
    --card-section-light: var(--section-ii-light);
    --card-section-glow: var(--section-ii-glow);
}

.card:nth-child(3)::before {
    background: linear-gradient(90deg, 
        var(--section-ii-color) 0%, 
        var(--section-ii-light) 50%,
        var(--section-ii-color) 100%
    );
}

.card:nth-child(3) .card-icon {
    color: var(--section-ii-light);
}

.card:nth-child(3):hover {
    border-color: rgba(46, 125, 50, 0.4);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 30px var(--section-ii-glow),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:nth-child(3):hover h3 a {
    color: var(--section-ii-light);
    text-shadow: 0 0 10px var(--section-ii-glow);
}

/* Section III - Probability (Teal/Cyan) */
.card:nth-child(4) {
    --card-section-color: var(--section-iii-color);
    --card-section-light: var(--section-iii-light);
    --card-section-glow: var(--section-iii-glow);
}

.card:nth-child(4)::before {
    background: linear-gradient(90deg, 
        var(--section-iii-color) 0%, 
        var(--section-iii-light) 50%,
        var(--section-iii-color) 100%
    );
}

.card:nth-child(4) .card-icon {
    color: var(--section-iii-light);
}

.card:nth-child(4):hover {
    border-color: rgba(0, 131, 143, 0.4);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 30px var(--section-iii-glow),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:nth-child(4):hover h3 a {
    color: var(--section-iii-light);
    text-shadow: 0 0 10px var(--section-iii-glow);
}

/* Section IV - Discrete Math (Deep Purple) */
.card:nth-child(5) {
    --card-section-color: var(--section-iv-color);
    --card-section-light: var(--section-iv-light);
    --card-section-glow: var(--section-iv-glow);
}

.card:nth-child(5)::before {
    background: linear-gradient(90deg, 
        var(--section-iv-color) 0%, 
        var(--section-iv-light) 50%,
        var(--section-iv-color) 100%
    );
}

.card:nth-child(5) .card-icon {
    color: var(--section-iv-light);
}

.card:nth-child(5):hover {
    border-color: rgba(106, 27, 154, 0.4);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 30px var(--section-iv-glow),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:nth-child(5):hover h3 a {
    color: var(--section-iv-light);
    text-shadow: 0 0 10px var(--section-iv-glow);
}

/* Section V - Machine Learning (Vibrant Orange) */
.card:nth-child(6) {
    --card-section-color: var(--section-v-color);
    --card-section-light: var(--section-v-light);
    --card-section-glow: var(--section-v-glow);
}

.card:nth-child(6)::before {
    background: linear-gradient(90deg, 
        var(--section-v-color) 0%, 
        var(--section-v-light) 50%,
        var(--section-v-color) 100%
    );
}

.card:nth-child(6) .card-icon {
    color: var(--section-v-light);
}

.card:nth-child(6):hover {
    border-color: rgba(239, 108, 0, 0.4);
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 30px var(--section-v-glow),
        inset 0 1px 0 rgba(255, 255, 255, 0.1);
}

.card:nth-child(6):hover h3 a {
    color: var(--section-v-light);
    text-shadow: 0 0 10px var(--section-v-glow);
}

/* ========== KNOWLEDGE MAP CARD (SPECIAL) ========== */
.card-map-highlight {
    background: linear-gradient(135deg, 
        rgba(20, 35, 55, 0.9) 0%, 
        rgba(15, 25, 40, 0.95) 100%
    );
    border: 1px solid rgba(100, 180, 255, 0.3);
}

.card-map-highlight::before {
    background: linear-gradient(90deg,
        #3498db 0%,
        #64b4ff 25%,
        #2ecc71 50%,
        #64b4ff 75%,
        #3498db 100%
    );
    background-size: 200% 100%;
    animation: mapCardShimmer 3s linear infinite;
    opacity: 1;
}

@keyframes mapCardShimmer {
    0% { background-position: 200% 0; }
    100% { background-position: -200% 0; }
}

/* ========== MERMAID DIAGRAM DARK THEME ========== */
.mermaid {
    background: rgba(0, 0, 0, 0.2);
    border-radius: 12px;
    padding: var(--spacing-md);
}

/* ========== BLOCKQUOTE DARK THEME ========== */
blockquote {
    background-color: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.2);
    color: var(--dark-text-secondary);
}

blockquote small {
    color: var(--dark-text-muted);
}

/* ========== LINKS ========== */
a {
    color: #64b4ff;
}

a:hover {
    color: #a0c4ff;
}

/* ========== SEARCH POPUP DARK THEME ========== */
#search-popup {
    background: var(--glass-bg-solid);
    border: 1px solid var(--glass-border);
    box-shadow: var(--glass-shadow);
}

.popup-result-item {
    background-color: rgba(255, 255, 255, 0.03);
    border-color: rgba(255, 255, 255, 0.1);
}

.popup-result-item:hover {
    background-color: rgba(100, 180, 255, 0.1);
    border-color: rgba(100, 180, 255, 0.2);
}

.popup-result-item h3 a {
    color: var(--dark-text-primary);
}

.popup-result-item h3 a:hover {
    color: #64b4ff;
}

.result-context {
    color: var(--dark-text-muted);
}

.no-results {
    background-color: rgba(255, 255, 255, 0.03);
    color: var(--dark-text-secondary);
}

mark {
    background-color: rgba(100, 180, 255, 0.3);
}

/* ========== KEYWORDS/TAGS DARK THEME ========== */
.keywords span,
.keyword {
    background-color: rgba(255, 255, 255, 0.08);
    border-color: rgba(255, 255, 255, 0.15);
    color: var(--dark-text-secondary);
}

.keywords span:hover,
.keyword:hover {
    background-color: rgba(100, 180, 255, 0.15);
    border-color: rgba(100, 180, 255, 0.3);
    color: var(--dark-text-primary);
}

.keywords-more {
    background-color: rgba(255, 255, 255, 0.05);
    border-color: rgba(255, 255, 255, 0.2);
    color: var(--dark-text-muted);
}

.keywords-more:hover {
    background-color: rgba(255, 255, 255, 0.1);
}

.keywords-more::after {
    background-color: var(--bg-footer);
}

/* ========== CARD BADGES DARK THEME ========== */

/* Code Included - subtle cool blue-gray */
.card-badge-code {
    background-color: rgba(100, 149, 237, 0.15);
    color: #a8c5f0;
    border: 1px solid rgba(100, 149, 237, 0.35);
}

/* Interactive Demo - subtle warm amber */
.card-badge-interactive {
    background-color: rgba(218, 165, 32, 0.15);
    color: #e8d08a;
    border: 1px solid rgba(218, 165, 32, 0.35);
}

/* Hide essential badge - not needed */
.card-badge-essential {
    display: none !important;
}

/* General card badge fallback */
.card-badge {
    background-color: rgba(255, 255, 255, 0.08);
    color: var(--dark-text-secondary);
    border: 1px solid rgba(255, 255, 255, 0.2);
}

.card-badge:hover {
    background-color: rgba(255, 255, 255, 0.12);
}

/* ========== FOOTER ENHANCEMENT ========== */
footer {
    border-top: 1px solid rgba(100, 180, 255, 0.1);
}

.footer-content {
    background: transparent;
}

/* ========== RESPONSIVE ADJUSTMENTS ========== */
@media (max-width: 768px) {
    .card {
        padding: var(--spacing-md);
    }
    
    .homepage-introduction,
    .update-notice,
    .content-sections,
    .references {
        padding: var(--spacing-md);
        border-radius: 12px;
    }
}

@media (max-width: 576px) {
    .card::before {
        height: 3px;
    }
    
    .card:hover::before {
        height: 4px;
    }
}

/* ========== REDUCED MOTION ========== */
@media (prefers-reduced-motion: reduce) {
    .card-map-highlight::before {
        animation: none;
    }
    
    .card,
    .card:hover {
        transition: none;
    }
}

/* ========== PRINT STYLES ========== */
@media print {
    body {
        background: #fff;
        color: #000;
    }
    
    body::before {
        display: none;
    }
    
    .card {
        background: #fff;
        border: 1px solid #ddd;
        color: #000;
    }
    
    .homepage-introduction,
    .update-notice,
    .content-sections,
    .references {
        background: #fff;
        color: #000;
    }
}

/* ========== SECTION PAGE THEMING ==========
 * These styles apply to section landing pages
 * (e.g., linear_algebra.html, probability.html)
 * All cards on a section page get that section's color
 * =========================================== */

/* Section I - Linear Algebra Pages */
body[data-section="I"] .card::before,
.section-i-theme .card::before {
    background: linear-gradient(90deg, 
        var(--section-i-color) 0%, 
        var(--section-i-light) 50%,
        var(--section-i-color) 100%
    ) !important;
    opacity: 0.9;
}

body[data-section="I"] .card .card-icon,
.section-i-theme .card .card-icon {
    color: var(--section-i-light);
}

body[data-section="I"] .card:hover,
.section-i-theme .card:hover {
    border-color: rgba(21, 101, 192, 0.5) !important;
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 40px var(--section-i-glow) !important;
}

body[data-section="I"] .card:hover h3 a,
.section-i-theme .card:hover h3 a {
    color: var(--section-i-light) !important;
    text-shadow: 0 0 10px var(--section-i-glow);
}

/* Section II - Calculus Pages */
body[data-section="II"] .card::before,
.section-ii-theme .card::before {
    background: linear-gradient(90deg, 
        var(--section-ii-color) 0%, 
        var(--section-ii-light) 50%,
        var(--section-ii-color) 100%
    ) !important;
    opacity: 0.9;
}

body[data-section="II"] .card .card-icon,
.section-ii-theme .card .card-icon {
    color: var(--section-ii-light);
}

body[data-section="II"] .card:hover,
.section-ii-theme .card:hover {
    border-color: rgba(46, 125, 50, 0.5) !important;
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 40px var(--section-ii-glow) !important;
}

body[data-section="II"] .card:hover h3 a,
.section-ii-theme .card:hover h3 a {
    color: var(--section-ii-light) !important;
    text-shadow: 0 0 10px var(--section-ii-glow);
}

/* Section III - Probability Pages */
body[data-section="III"] .card::before,
.section-iii-theme .card::before {
    background: linear-gradient(90deg, 
        var(--section-iii-color) 0%, 
        var(--section-iii-light) 50%,
        var(--section-iii-color) 100%
    ) !important;
    opacity: 0.9;
}

body[data-section="III"] .card .card-icon,
.section-iii-theme .card .card-icon {
    color: var(--section-iii-light);
}

body[data-section="III"] .card:hover,
.section-iii-theme .card:hover {
    border-color: rgba(0, 131, 143, 0.5) !important;
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 40px var(--section-iii-glow) !important;
}

body[data-section="III"] .card:hover h3 a,
.section-iii-theme .card:hover h3 a {
    color: var(--section-iii-light) !important;
    text-shadow: 0 0 10px var(--section-iii-glow);
}

/* Section IV - Discrete Math Pages */
body[data-section="IV"] .card::before,
.section-iv-theme .card::before {
    background: linear-gradient(90deg, 
        var(--section-iv-color) 0%, 
        var(--section-iv-light) 50%,
        var(--section-iv-color) 100%
    ) !important;
    opacity: 0.9;
}

body[data-section="IV"] .card .card-icon,
.section-iv-theme .card .card-icon {
    color: var(--section-iv-light);
}

body[data-section="IV"] .card:hover,
.section-iv-theme .card:hover {
    border-color: rgba(106, 27, 154, 0.5) !important;
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 40px var(--section-iv-glow) !important;
}

body[data-section="IV"] .card:hover h3 a,
.section-iv-theme .card:hover h3 a {
    color: var(--section-iv-light) !important;
    text-shadow: 0 0 10px var(--section-iv-glow);
}

/* Section V - Machine Learning Pages */
body[data-section="V"] .card::before,
.section-v-theme .card::before {
    background: linear-gradient(90deg, 
        var(--section-v-color) 0%, 
        var(--section-v-light) 50%,
        var(--section-v-color) 100%
    ) !important;
    opacity: 0.9;
}

body[data-section="V"] .card .card-icon,
.section-v-theme .card .card-icon {
    color: var(--section-v-light);
}

body[data-section="V"] .card:hover,
.section-v-theme .card:hover {
    border-color: rgba(239, 108, 0, 0.5) !important;
    box-shadow: 
        0 20px 50px rgba(0, 0, 0, 0.4),
        0 0 40px var(--section-v-glow) !important;
}

body[data-section="V"] .card:hover h3 a,
.section-v-theme .card:hover h3 a {
    color: var(--section-v-light) !important;
    text-shadow: 0 0 10px var(--section-v-glow);
}

/* ========== FIX FOR BOLD LINKS ========== */
/* Ensures bold text inside links inherits the link color instead of turning white */
.section-content a strong,
.section-content strong a,
a strong {
    color: #64b4ff !important; /* Forces the link color */
    text-decoration: underline;
    text-decoration-thickness: 1.5px;
    text-underline-offset: 3px;
    transition: color 0.3s ease;
}

/* Hover state for bold links */
.section-content a:hover strong,
.section-content strong a:hover,
a:hover strong {
    color: #a0c4ff !important; /* Lighter blue on hover */
    text-decoration-color: #a0c4ff;
}